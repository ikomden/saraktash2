ВЫБРАТЬ
	ЗапасыОстатки.Номенклатура,
	NULL КАК Характеристика,
	ЗапасыОстатки.КоличествоОстаток
ПОМЕСТИТЬ ВременнаяТаблицаСвободныеОстатки
ИЗ
	РегистрНакопления.Запасы.Остатки КАК ЗапасыОстатки
;
///////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Товары.Ссылка КАК Номенклатура,
	NULL КАК Характеристика,
	Товары.ПометкаУдаления,
	ТоварыПоКатегориям.Категория КАК Родитель,
	ТоварыПоКатегориям.Категория КАК КатегорияНоменклатуры,
	Товары.ЭтоГруппа,
	Товары.Код,
	Товары.Наименование,
	Товары.Артикул,
	Товары.ВидНоменклатуры КАК ТипНоменклатуры,
	Товары.ЕдиницаИзмерения,
	NULL КАК СтавкаНДС,
	Изображения.Ссылка КАК ФайлКартинки,
	NULL КАК ХарактеристикаНаименование,
	NULL КАК ХарактеристикаПометкаУдаления	
ПОМЕСТИТЬ ВременнаяТаблицаНоменклатураХарактеристики
ИЗ
	Справочник.Номенклатура КАК Товары
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ТоварыПоКатегориям КАК ТоварыПоКатегориям
		ПО Товары.Ссылка = ТоварыПоКатегориям.Номенклатура
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Изображения КАК Изображения
		ПО Товары.Ссылка = Изображения.Владелец
ГДЕ
	Товары.ВыгружатьНаСайт = ИСТИНА
	И Товары.ВидНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ВидыНоменклатуры.Товар)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВременнаяТаблицаНоменклатураХарактеристики.Номенклатура КАК Номенклатура,
	ВременнаяТаблицаНоменклатураХарактеристики.Характеристика КАК Характеристика,
	ВременнаяТаблицаНоменклатураХарактеристики.ПометкаУдаления КАК ПометкаУдаления,
	ВременнаяТаблицаНоменклатураХарактеристики.Родитель КАК Родитель,
	ВременнаяТаблицаНоменклатураХарактеристики.КатегорияНоменклатуры КАК КатегорияНоменклатуры,
	ВременнаяТаблицаНоменклатураХарактеристики.ЭтоГруппа КАК ЭтоГруппа,
	ВременнаяТаблицаНоменклатураХарактеристики.Код КАК Код,
	ВременнаяТаблицаНоменклатураХарактеристики.Наименование КАК Наименование,
	ВременнаяТаблицаНоменклатураХарактеристики.Артикул КАК Артикул,
	ВременнаяТаблицаНоменклатураХарактеристики.ТипНоменклатуры КАК ТипНоменклатуры,
	ВременнаяТаблицаНоменклатураХарактеристики.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ВременнаяТаблицаНоменклатураХарактеристики.СтавкаНДС КАК СтавкаНДС,
	ВременнаяТаблицаНоменклатураХарактеристики.ФайлКартинки КАК ФайлКартинки,
	ВременнаяТаблицаНоменклатураХарактеристики.ХарактеристикаНаименование КАК ХарактеристикаНаименование,
	ВременнаяТаблицаНоменклатураХарактеристики.ХарактеристикаПометкаУдаления КАК ХарактеристикаПометкаУдаления,
	ЕСТЬNULL(ВременнаяТаблицаСвободныеОстатки.КоличествоОстаток, 0) КАК Остаток,
	 "Товар" КАК ВидНоменклатуры
ПОМЕСТИТЬ ВременнаяТаблицаНоменклатураХарактеристикиОстатки
ИЗ
	ВременнаяТаблицаНоменклатураХарактеристики КАК ВременнаяТаблицаНоменклатураХарактеристики
		ЛЕВОЕ СОЕДИНЕНИЕ ВременнаяТаблицаСвободныеОстатки КАК ВременнаяТаблицаСвободныеОстатки
		ПО ВременнаяТаблицаНоменклатураХарактеристики.Номенклатура = ВременнаяТаблицаСвободныеОстатки.Номенклатура
			И ВременнаяТаблицаНоменклатураХарактеристики.Характеристика = ВременнаяТаблицаСвободныеОстатки.Характеристика
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ВременнаяТаблицаСвободныеОстатки
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ВременнаяТаблицаНоменклатураХарактеристики
;
////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВидыЦен.Ссылка КАК ВидЦен,
	NULL КАК ВалютаЦены,
	NULL КАК ЦенаВключаетНДС
ПОМЕСТИТЬ ВременнаяТаблицаВидыЦен
ИЗ
	Справочник.ВидыЦен КАК ВидыЦен
ГДЕ
	ВидыЦен.Ссылка В(&ВидыЦен)
;
////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВременнаяТаблицаНоменклатураХарактеристикиОстатки.Номенклатура КАК Номенклатура,
	ВременнаяТаблицаНоменклатураХарактеристикиОстатки.Характеристика КАК Характеристика,
	ВременнаяТаблицаНоменклатураХарактеристикиОстатки.ПометкаУдаления КАК ПометкаУдаления,
	ВременнаяТаблицаНоменклатураХарактеристикиОстатки.Родитель КАК Родитель,
	ВременнаяТаблицаНоменклатураХарактеристикиОстатки.КатегорияНоменклатуры КАК КатегорияНоменклатуры,
	ВременнаяТаблицаНоменклатураХарактеристикиОстатки.ЭтоГруппа КАК ЭтоГруппа,
	ВременнаяТаблицаНоменклатураХарактеристикиОстатки.Код КАК Код,
	ВременнаяТаблицаНоменклатураХарактеристикиОстатки.Наименование КАК Наименование,
	ВременнаяТаблицаНоменклатураХарактеристикиОстатки.Артикул КАК Артикул,
	ВременнаяТаблицаНоменклатураХарактеристикиОстатки.ТипНоменклатуры КАК ТипНоменклатуры,
	ВременнаяТаблицаНоменклатураХарактеристикиОстатки.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ВременнаяТаблицаНоменклатураХарактеристикиОстатки.СтавкаНДС КАК НоменклатураСтавкаНДС,
	ВременнаяТаблицаНоменклатураХарактеристикиОстатки.ФайлКартинки КАК ФайлКартинки,
	ВременнаяТаблицаНоменклатураХарактеристикиОстатки.ХарактеристикаНаименование КАК ХарактеристикаНаименование,
	ВременнаяТаблицаНоменклатураХарактеристикиОстатки.ХарактеристикаПометкаУдаления КАК ХарактеристикаПометкаУдаления,
	ВременнаяТаблицаНоменклатураХарактеристикиОстатки.ВидНоменклатуры КАК ВидНоменклатуры,
	ВременнаяТаблицаНоменклатураХарактеристикиОстатки.Остаток КАК Остаток,
	ВременнаяТаблицаВидыЦен.ВидЦен КАК ВидЦен,
	ВременнаяТаблицаВидыЦен.ВалютаЦены КАК ВалютаЦены,
	ВременнаяТаблицаВидыЦен.ЦенаВключаетНДС КАК ЦенаВключаетНДС
ПОМЕСТИТЬ ВременнаяТаблицаНоменклатураВидыЦен
ИЗ
	ВременнаяТаблицаНоменклатураХарактеристикиОстатки КАК ВременнаяТаблицаНоменклатураХарактеристикиОстатки
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВременнаяТаблицаВидыЦен КАК ВременнаяТаблицаВидыЦен
		ПО (ИСТИНА)
;
////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	ВременнаяТаблицаНоменклатураВидыЦен.Номенклатура КАК Номенклатура,
	ВременнаяТаблицаНоменклатураВидыЦен.Характеристика КАК Характеристика,
	ВременнаяТаблицаНоменклатураВидыЦен.ПометкаУдаления КАК ПометкаУдаления,
	ВременнаяТаблицаНоменклатураВидыЦен.Родитель КАК Родитель,
	ВременнаяТаблицаНоменклатураВидыЦен.КатегорияНоменклатуры КАК КатегорияНоменклатуры,
	ВременнаяТаблицаНоменклатураВидыЦен.ЭтоГруппа КАК ЭтоГруппа,
	ВременнаяТаблицаНоменклатураВидыЦен.Код КАК Код,
	ВременнаяТаблицаНоменклатураВидыЦен.Наименование КАК Наименование,
	ВременнаяТаблицаНоменклатураВидыЦен.Артикул КАК Артикул,
	ВременнаяТаблицаНоменклатураВидыЦен.ТипНоменклатуры КАК ТипНоменклатуры,
	ВременнаяТаблицаНоменклатураВидыЦен.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ВременнаяТаблицаНоменклатураВидыЦен.НоменклатураСтавкаНДС КАК НоменклатураСтавкаНДС,
	ВременнаяТаблицаНоменклатураВидыЦен.ФайлКартинки КАК ФайлКартинки,
	ВременнаяТаблицаНоменклатураВидыЦен.ХарактеристикаНаименование КАК ХарактеристикаНаименование,
	ВременнаяТаблицаНоменклатураВидыЦен.ХарактеристикаПометкаУдаления КАК ХарактеристикаПометкаУдаления,
	ВременнаяТаблицаНоменклатураВидыЦен.ВидЦен КАК ВидЦен,
	ВременнаяТаблицаНоменклатураВидыЦен.ВалютаЦены КАК ВалютаЦены,
	ВременнаяТаблицаНоменклатураВидыЦен.ЦенаВключаетНДС КАК ЦенаВключаетНДС,
	ВременнаяТаблицаНоменклатураВидыЦен.ВидНоменклатуры КАК ВидНоменклатуры,
	ВременнаяТаблицаНоменклатураВидыЦен.Остаток КАК Остаток,
	ЦеныНоменклатурыСрезПоследних.Цена КАК Цена
ПОМЕСТИТЬ ВременнаяТаблицаЦены
ИЗ
	ВременнаяТаблицаНоменклатураВидыЦен КАК ВременнаяТаблицаНоменклатураВидыЦен
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦеныНоменклатуры.СрезПоследних(
				,
				Актуальность
					И (Номенклатура) В
						(ВЫБРАТЬ
							ВременнаяТаблицаНоменклатураХарактеристикиОстатки.Номенклатура,
							ВременнаяТаблицаНоменклатураХарактеристикиОстатки.Характеристика
						ИЗ
							ВременнаяТаблицаНоменклатураХарактеристикиОстатки КАК ВременнаяТаблицаНоменклатураХарактеристикиОстатки)) КАК ЦеныНоменклатурыСрезПоследних
		ПО ВременнаяТаблицаНоменклатураВидыЦен.Номенклатура = ЦеныНоменклатурыСрезПоследних.Номенклатура
			И ВременнаяТаблицаНоменклатураВидыЦен.ВидЦен = ЦеныНоменклатурыСрезПоследних.ВидЦен

;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ВременнаяТаблицаНоменклатураВидыЦен
;



////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЦеныСрезПоследних.Номенклатура,
	ЦеныСрезПоследних.ВидЦен,
	ЦеныСрезПоследних.Цена
ПОМЕСТИТЬ Цены
ИЗ
	РегистрСведений.Цены.СрезПоследних(, ВидЦен В (&ВидыЦен)) КАК ЦеныСрезПоследних
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Товары.Ссылка КАК Номенклатура,
	Товары.ПометкаУдаления,
	ТоварыПоКатегориям.Категория КАК Родитель,
	ТоварыПоКатегориям.Категория КАК КатегорияНоменклатуры,
	Товары.ЭтоГруппа,
	Товары.Код,
	Товары.Артикул,
	Товары.Наименование,
	Товары.ВидНоменклатуры КАК ТипНоменклатуры,
	Остатки.КоличествоОстаток КАК Остаток,
	Цены.ВидЦен,
	Цены.Цена,
	Товары.ЕдиницаИзмерения,
	Товары.ЕдиницаИзмерения.Код,
	Товары.ЕдиницаИзмерения.НаименованиеПолное,
	Товары.ЕдиницаИзмерения.МеждународноеСокращение,
	"Товар" КАК ВидНоменклатуры,
	Изображения.Ссылка КАК ФайлКартинки
ИЗ
	Справочник.Номенклатура КАК Товары
		ЛЕВОЕ СОЕДИНЕНИЕ Остатки КАК Остатки
		ПО Товары.Ссылка = Остатки.Номенклатура
		ЛЕВОЕ СОЕДИНЕНИЕ Цены КАК Цены
		ПО Товары.Ссылка = Цены.Номенклатура
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ТоварыПоКатегориям КАК ТоварыПоКатегориям
		ПО Товары.Ссылка = ТоварыПоКатегориям.Номенклатура
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Изображения КАК Изображения
		ПО Товары.Ссылка = Изображения.Владелец
ГДЕ
	Товары.ВыгружатьНаСайт = ИСТИНА
	И Товары.ВидНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ВидыНоменклатуры.Товар)